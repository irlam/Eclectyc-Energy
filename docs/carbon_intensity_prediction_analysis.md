# Carbon Intensity Prediction from Meter Readings

## Summary
**Question:** Is it possible to predict Carbon Intensity from meter readings?

**Short Answer:** No, you cannot directly predict grid carbon intensity from individual meter readings. However, you can:
1. **Calculate carbon emissions** from your consumption using known carbon intensity data
2. **Analyze carbon footprint patterns** by combining your meter data with grid carbon intensity
3. **Optimize consumption timing** based on carbon intensity forecasts to reduce emissions

## Why You Can't Predict Carbon Intensity from Meter Readings

### 1. Carbon Intensity is a Grid-Level Metric
- **Carbon intensity** (gCO2/kWh) measures how much CO2 is emitted per kWh of electricity generated by the national grid
- It depends on the **energy generation mix** (coal, gas, nuclear, wind, solar, etc.)
- Your meter readings only show **consumption**, not generation sources

### 2. No Causal Relationship
- Meter readings show **when and how much** electricity you used
- Carbon intensity shows **how clean** the grid electricity was at that time
- Individual consumption doesn't influence grid carbon intensity (unless you have massive industrial loads)
- The grid's generation mix determines carbon intensity based on demand forecasts, weather, fuel availability, etc.

### Example:
- You consume 10 kWh at 2pm ‚Üí Your meter reads 10 kWh
- Grid carbon intensity at 2pm: 250 gCO2/kWh (lots of gas generation)
- Grid carbon intensity at 3pm: 150 gCO2/kWh (more wind generation)
- Your consumption didn't change the grid mix; the grid mix changed independently

## What You CAN Do with Meter Readings + Carbon Intensity

### 1. Calculate Your Carbon Emissions ‚úÖ
**Current Implementation:** The platform can combine meter readings with carbon intensity data.

```
Carbon Emissions (kg CO2) = Consumption (kWh) √ó Carbon Intensity (gCO2/kWh) √∑ 1000
```

**Example:**
- Meter reading: 100 kWh consumed on 2024-11-08
- Carbon intensity: 200 gCO2/kWh (from National Grid API)
- Emissions: 100 √ó 200 √∑ 1000 = 20 kg CO2

### 2. Analyze Carbon Footprint Patterns ‚úÖ
Combine your half-hourly meter data with carbon intensity to see:
- **When** your consumption has the highest carbon impact
- **Which sites/meters** contribute most to carbon emissions
- **Trends** in your carbon footprint over time
- **Opportunities** to shift consumption to lower-carbon periods

### 3. Optimize Consumption Timing üîÑ
Use carbon intensity **forecasts** to:
- Schedule high-consumption activities during low-carbon periods
- Delay non-urgent loads when carbon intensity is high
- Charge battery storage when grid is cleanest
- Run manufacturing processes during off-peak renewable generation

## Current Platform Capabilities

### ‚úÖ What's Already Implemented
1. **Real-time Carbon Intensity Data**
   - Fetches live data from National Grid ESO API
   - Stores in `external_carbon_intensity` table
   - Dashboard displays current intensity with color coding

2. **Historical Carbon Data**
   - API endpoint: `/api/carbon-intensity/history?days=7`
   - Can retrieve past intensity data
   - Useful for emission calculations

3. **Meter Reading Storage**
   - Half-hourly consumption data in `meter_readings`
   - Daily aggregations in `daily_aggregations`
   - Ready to combine with carbon intensity

### üü° What Could Be Added

#### A. Carbon Emission Reporting
Create a new report combining meter readings with carbon intensity:

**Features:**
- Calculate total carbon emissions per site/meter
- Show emissions trends over time
- Compare emissions across different periods
- Identify high-carbon consumption patterns

**SQL Query Example:**
```sql
SELECT 
    m.mpan,
    s.name as site_name,
    da.date,
    da.total_consumption as kwh,
    eci.intensity as carbon_intensity_gco2_kwh,
    (da.total_consumption * eci.intensity / 1000) as emissions_kg_co2
FROM daily_aggregations da
JOIN meters m ON da.meter_id = m.id
JOIN sites s ON m.site_id = s.id
LEFT JOIN external_carbon_intensity eci 
    ON DATE(eci.datetime) = da.date 
    AND eci.region = 'GB'
WHERE da.date BETWEEN '2024-11-01' AND '2024-11-08'
ORDER BY emissions_kg_co2 DESC;
```

#### B. Carbon-Optimized Scheduling Recommendations
Analyze consumption patterns and suggest timing changes:

**Features:**
- Identify consumption that could be shifted to lower-carbon periods
- Calculate potential emission savings
- Recommend optimal times for high-consumption activities
- Track emission reduction goals

#### C. Carbon Intensity Forecasting (External API)
Note: This uses **grid-level forecasts**, not predictions from your data:

**National Grid ESO API provides:**
- Short-term forecasts (next 48 hours)
- Updated every 30 minutes
- Based on generation scheduling and weather forecasts

**Use Case:**
```
1. Check forecast: Low carbon intensity expected 2am-6am tomorrow
2. Schedule: Charge EV batteries, run water heaters, batch processes
3. Result: Same energy consumption, lower carbon emissions
```

## Implementation Recommendations

### Priority 1: Carbon Emission Reporting Dashboard
**Effort:** Medium (2-3 days)
**Impact:** High - immediate visibility into carbon footprint

**Tasks:**
- Create `/reports/carbon-emissions` page
- Join meter readings with carbon intensity data
- Calculate and display total emissions
- Show emissions by site, meter, time period
- Add emission trends and comparisons

### Priority 2: Carbon Intensity Overlay on Consumption Reports
**Effort:** Low (1 day)
**Impact:** Medium - contextualizes consumption data

**Tasks:**
- Add carbon intensity column to consumption report
- Calculate emissions for each row
- Show carbon intensity trend charts
- Color-code high/low carbon periods

### Priority 3: Optimization Recommendations Engine
**Effort:** High (5-7 days)
**Impact:** High - actionable insights for reduction

**Tasks:**
- Analyze consumption patterns
- Identify shiftable loads
- Calculate potential savings
- Generate scheduling recommendations
- Track implemented changes

## Technical Architecture

### Data Flow
```
1. National Grid ESO API ‚Üí CarbonIntensityService
2. Store in external_carbon_intensity table
3. Join with meter_readings or daily_aggregations
4. Calculate emissions = consumption √ó intensity
5. Display in reports and dashboards
```

### Required Database Queries
```sql
-- Get carbon emissions for a date range
SELECT 
    DATE(mr.reading_date) as date,
    m.mpan,
    SUM(mr.reading_value) as total_kwh,
    AVG(eci.intensity) as avg_carbon_intensity,
    SUM(mr.reading_value * eci.intensity / 1000) as total_emissions_kg
FROM meter_readings mr
JOIN meters m ON mr.meter_id = m.id
LEFT JOIN external_carbon_intensity eci 
    ON DATE(eci.datetime) = DATE(mr.reading_date)
    AND HOUR(eci.datetime) = HOUR(mr.reading_time)
WHERE mr.reading_date BETWEEN ? AND ?
GROUP BY DATE(mr.reading_date), m.mpan;
```

## Key Takeaways

‚úÖ **You CAN:**
- Calculate carbon emissions from your consumption
- Analyze when your usage has highest carbon impact
- Optimize consumption timing using forecasts
- Track and report on carbon footprint

‚ùå **You CANNOT:**
- Predict grid carbon intensity from meter readings
- Infer energy generation mix from consumption data
- Calculate carbon intensity without external data sources

## Next Steps

1. **Review current carbon intensity implementation**
   - Check if data is being fetched regularly
   - Verify storage in database
   - Test API endpoints

2. **Implement carbon emission reporting**
   - Create new report page
   - Join consumption with carbon data
   - Calculate and display emissions

3. **Add carbon optimization features**
   - Use forecast data for recommendations
   - Track emission reduction progress
   - Enable carbon-aware scheduling

## References

- National Grid ESO Carbon Intensity API: https://carbonintensity.org.uk/
- Current implementation: `app/Services/CarbonIntensityService.php`
- Database table: `external_carbon_intensity` (migration 003)
- Carbon API endpoints: `/api/carbon-intensity/*`

---

**Document created:** November 8, 2025  
**Related to:** Carbon intensity prediction inquiry
