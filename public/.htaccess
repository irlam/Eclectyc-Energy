DirectoryIndex index.php

<IfModule mod_negotiation.c>
	Options -MultiViews -Indexes
</IfModule>

<IfModule mod_authz_core.c>
	Require all granted
</IfModule>

RewriteEngine On
RewriteBase /

# Handle WebSocket upgrade requests (if needed in future)
# These will be routed through index.php for now
RewriteCond %{HTTP:Upgrade} websocket [NC]
RewriteCond %{HTTP:Connection} upgrade [NC]
RewriteRule ^(.*)$ index.php [L,QSA]

# Prevent direct access to index.php - always route through Slim
RewriteCond %{REQUEST_URI} ^/index\.php$
RewriteRule ^index\.php$ / [R=301,L]

# Skip existing files/directories (except index.php)
RewriteCond %{REQUEST_FILENAME} -f
RewriteCond %{REQUEST_FILENAME} !index.php$
RewriteRule ^ - [L]

RewriteCond %{REQUEST_FILENAME} -d
RewriteRule ^ - [L]

# Route everything else through index.php
RewriteRule ^ index.php [QSA,L]

# Custom error pages (optional)
ErrorDocument 404 /index.php
ErrorDocument 403 /index.php
